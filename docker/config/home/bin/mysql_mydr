#!/bin/bash

mysql_dir=/home/worker/data/www/xd-laravel/docker/mysql
mysql_data_dir=$mysql_dir/data
mysql_conf=$mysql_dir/../backup-my.cnf
mysql_run_dir=/home/worker/data/mysql
mysql_pid_file=$mysql_run_dir/run/mysql.pid
mysql_errorlog_file=$mysql_run_dir/logs/error.log
mysql_password="xiandan"

function stop_mysql()
{
    printf "Stoping Mysql...\n"
    mysqladmin -uroot -p$mysql_password shutdown
}

function start_mysql()
{
    printf "Starting Mysql...\n"
    cmd="sudo mysqld --defaults-file=$mysql_conf --user=mysql --datadir=$mysql_data_dir --log-error=$mysql_errorlog_file &"
    echo $cmd
    `$cmd`
}

function restart_mysql()
{
    printf "Restarting Mysql...\n"
    stop_mysql
    sleep 5
    start_mysql
}

if [ "$1" = "start" ]; then
    start_mysql
elif [ "$1" = "stop" ]; then
    stop_mysql
elif [ "$1" = "restart" ]; then
    restart_mysql
else
    printf "Usage: /home/worker/bin/mysql_mydr {start|stop|restart}\n"
fi
	
